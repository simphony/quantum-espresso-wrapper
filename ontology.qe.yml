---
version: "0.1"
namespace: "QE"
author: "Mathias Driesse"

ontology:

    ############################ Relationships
    
    HAS_PART:
        description: "default relationship"
        subclass_of:
            - CUBA.ACTIVE_RELATIONSHIP
        inverse: QE.IS_PART_OF
        default_rel: true

    IS_PART_OF:
        description: "inverse of the default relationship"
        subclass_of:
            -  CUBA.PASSIVE_RELATIONSHIP
        inverse: QE.HAS_PART
        
    ############################ Framework
    
    QE_WRAPPER:
        description: "The quantum espresso wrapper"
        subclass_of:
            - CUBA.WRAPPER
            - QE.HAS_PART:
                cardinality: 1
                exclusive: true
                range: QE.SIMULATION
    
    SIMULATION:
        description: "All components of the simulation that are needed to run the model"
        subclass_of:
            - CUBA.ENTITY
            - QE.HAS_PART:
                cardinality: 1
                exclusive: false
                range: QE.CELL
            - QE.HAS_PART:
                cardinality: 1
                exclusive: false
                range: QE.TOTAL_ENERGY


    ############################ Physical objects

    CELL:
        subclass_of:
            - CUBA.ENTITY
            - QE.HAS_PART:
                range: QE.ATOM
                cardinality: 1+
            - QE.HAS_PART:
                range: QE.CELL_PARAMS
        
    ATOM:
        subclass_of:
            - CUBA.ENTITY
            - QE.HAS_PART:
                range: QE.POSITION
                cardinality: 1

    ELEMENT:
        subclass_of:
            - CUBA.ENTITY
            - QE.HAS_PART:
                range: QE.MASS
                cardinality: 1
            - QE.HAS_PART:
                range: QE.ATOM
                cardinality: 1+
            - QE.HAS_PART:
                range: QE.PSEUDOPOTENTIAL
                cardinality: 1
        attributes:
            QE.NAME:

    PSEUDOPOTENTIAL:
        subclass_of:
            - CUBA.ENTITY
        attributes:
            QE.NAME:

    ############################ Physical quantities

    PHYSICAL_QUANTITY:
        attributes:
            QE.VALUE:
            QE.UNIT:
        subclass_of:
            - CUBA.ENTITY

    PHYSICAL_QUANTITY_VECTOR:
        attributes:
            QE.VECTOR:
            QE.UNIT:
        subclass_of:
            - CUBA.ENTITY

    POSITION:
        description: "Position of an entity"
        subclass_of: 
            - QE.PHYSICAL_QUANTITY_VECTOR

    MASS:
        description: "Mass of an entity"
        subclass_of:
            - QE.PHYSICAL_QUANTITY

    CELL_PARAMS:
        subclass_of:
            - CUBA.ENTITY
            - QE.HAS_PART:
                range: QE.CELL_PARAMETER_X
                cardinality: 1
            - QE.HAS_PART:
                range: QE.CELL_PARAMETER_Y
                cardinality: 1
            - QE.HAS_PART:
                range: QE.CELL_PARAMETER_Z
                cardinality: 1
            

    CELL_PARAMETER_X:
        subclass_of:
            - QE.PHYSICAL_QUANTITY_VECTOR
    
    CELL_PARAMETER_Y:
        subclass_of:
            - QE.PHYSICAL_QUANTITY_VECTOR

    CELL_PARAMETER_Z:
        subclass_of:
            - QE.PHYSICAL_QUANTITY_VECTOR

    TOTAL_ENERGY:
        subclass_of:
            - QE.PHYSICAL_QUANTITY
                

    ############################ Attributes

    VALUE:
        subclass_of:
            - CUBA.ATTRIBUTE
        datatype: FLOAT

    UNIT:
        subclass_of:
            - CUBA.ATTRIBUTE
        datatype: STRING

    VECTOR:
        subclass_of:
            - CUBA.ATTRIBUTE
        datatype: VECTOR:3

    DBLVECTOR:
        subclass_of:
            - CUBA.ATTRIBUTE
        datatype: VECTOR:6

    NAME:
        subclass_of:
            - CUBA.ATTRIBUTE
        datatype: STRING

    ############################ Various extensions to be implemented

    LATTICE_PARAMETERS:
        subclass_of:
            - CUBA.ENTITY

    LATTICE_PARAMETER_A:
        subclass_of:
            - QE.PHYSICAL_QUANTITY
    
    LATTICE_PARAMETER_B:
        subclass_of:
            - QE.PHYSICAL_QUANTITY

    LATTICE_PARAMETER_C:
        subclass_of:
            - QE.PHYSICAL_QUANTITY

    ECUTWFC:
        description: Kinetic energy cutoff for wavefunctions (Ry)
        subclass_of:
            - QE.PHYSICAL_QUANTITY
    
    ECUTRHO:
        description: Kinetic energy cutoff for charge density and potential (Ry)
        subclass_of:
            - QE.PHYSICAL_QUANTITY

    DEGAUSS:
        description: Value of the gaussian spreading for brillouin-zone integration in metals (Ry)
        subclass_of:
            - QE.PHYSICAL_QUANTITY

    K_POINTS:
        description: Placeholder
        subclass_of:
            - QE.PHYSICAL_QUANTITY_VECTOR

    CELLDM1:
        description: Placeholder
        subclass_of:
            - QE.PHYSICAL_QUANTITY

    

    



    

    
        
    
    
        
       
        

    